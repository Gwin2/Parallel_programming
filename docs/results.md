
# Результаты тестирования и бенчмарки

## Обзор производительности

В этом документе представлены результаты тестирования и измерения производительности решателя PETSc GMRES.

## Тестовые конфигурации

### Аппаратное обеспечение
- **Процессор**: Intel I9-13900  (24 ядер, 3.2 GHz)
- **Память**: 32 GB DDR5
- **Сеть**: InfiniBand FDR

### Программное обеспечение
- **ОС**: Ubuntu 20.04 LTS
- **MPI**: OpenMPI 4.0.3
- **PETSc**: 3.18.0
- **Компилятор**: GCC 9.3.0

## Результаты тестирования

### Тест 1: Диагональные системы

| Размер | Процессы | Итерации | Время (сек) | Невязка |
|--------|----------|----------|-------------|---------|
| 100    | 1        | 1        | 0.001       | 1.2e-15 |
| 1000   | 1        | 1        | 0.005       | 2.1e-14 |
| 1000   | 4        | 1        | 0.003       | 2.1e-14 |
| 10000  | 4        | 1        | 0.025       | 1.8e-13 |

**Вывод**: Для диагональных систем метод сходится за 1 итерацию.

### Тест 2: Матрицы Лапласа

| Размер | Процессы | Итерации | Время (сек) | Невязка |
|--------|----------|----------|-------------|---------|
| 100    | 1        | 28       | 0.015       | 8.7e-08 |
| 500    | 1        | 65       | 0.125       | 9.2e-08 |
| 1000   | 1        | 92       | 0.342       | 8.5e-08 |
| 1000   | 4        | 92       | 0.198       | 8.5e-08 |
| 5000   | 4        | 208      | 2.456       | 9.1e-08 |

### Тест 3: Сравнение предобуславливателей

Матрица: Лаплас 1000x1000, 4 процесса

| Предобуславливатель | Итерации | Время (сек) | Ускорение |
|---------------------|----------|-------------|-----------|
| None                | 184      | 0.421       | 1.0x      |
| Jacobi              | 92       | 0.198       | 2.1x      |
| ILU                 | 45       | 0.135       | 3.1x      |

## Масштабируемость

### Слабый масштабинг
(Размер матрицы пропорционален числу процессов)

| Процессы | Размер матрицы | Время (сек) | Эффективность |
|----------|----------------|-------------|---------------|
| 1        | 1000           | 0.342       | 100%          |
| 2        | 2000           | 0.385       | 89%           |
| 4        | 4000           | 0.423       | 81%           |
| 8        | 8000           | 0.512       | 67%           |

### Сильный масштабинг
(Фиксированный размер матрицы 4000x4000)

| Процессы | Время (сек) | Ускорение | Эффективность |
|----------|-------------|-----------|---------------|
| 1        | 5.234       | 1.00x     | 100%          |
| 2        | 2.845       | 1.84x     | 92%           |
| 4        | 1.523       | 3.44x     | 86%           |
| 8        | 0.892       | 5.87x     | 73%           |

## Анализ памяти

### Использование памяти для различных размеров матриц

| Размер матрицы | Память (MB) | Ненулевые элементы |
|----------------|-------------|-------------------|
| 100            | 0.8         | 298               |
| 1000           | 12.5        | 2,998             |
| 5000           | 285.3       | 14,998            |
| 10000          | 1,124.7     | 29,998            |

## Графики сходимости

### Сходимость для матрицы Лапласа 1000x1000
Итерация 0: невязка = 1.000000e+00
Итерация 1: невязка = 4.472136e-01
Итерация 2: невязка = 2.236068e-01
...
Итерация 90: невязка = 8.523672e-08
Итерация 91: невязка = 8.498234e-08


### Сравнение предобуславливателей
![Convergence Comparison](convergence_plot.png)

## Статистика производительности

### Время выполнения по компонентам

| Компонент | Время (сек) | % от общего |
|-----------|-------------|-------------|
| Настройка KSP | 0.045 | 15% |
| Предобуславливание | 0.085 | 28% |
| Итерации GMRES | 0.168 | 56% |
| Общее | 0.298 | 100% |

## Рекомендации по оптимизации

### На основе результатов

1. **Для маленьких матриц** (< 1000): использовать ILU предобуславливание
2. **Для средних матриц** (1000-5000): использовать Jacobi с 4 процессами
3. **Для больших матриц** (> 5000): использовать доменное разложение

### Оптимальные параметры

```bash
# Маленькие матрицы
mpirun -np 2 ./petsc_solver -n 500 -pc_type ilu

# Средние матрицы  
mpirun -np 4 ./petsc_solver -n 2000 -pc_type jacobi

# Большие матрицы
mpirun -np 8 ./petsc_solver -n 10000 -pc_type asm